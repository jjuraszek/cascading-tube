apply plugin: 'scala'
apply plugin: 'maven'
apply plugin: 'idea'


group = 'org.tube'
version = '1.02'

repositories {
  mavenCentral()
  maven {
    url 'http://conjars.org/repo'
  }
  maven {
    url 'https://repository.cloudera.com/artifactory/cloudera-repos'
  }
}

dependencies {
  compile(
      'org.scala-lang:scala-library:2.10.2',
      'cascading:cascading-core:2.1.6',
      'cascading:cascading-local:2.1.6',
      'cascading:cascading-hadoop:2.1.6',
  )
}

tasks.withType(ScalaCompile) {
  scalaCompileOptions.useAnt = false
  scalaCompileOptions.additionalParameters = ['-target:jvm-1.6','-feature','-language:implicitConversions']
  configure(scalaCompileOptions.forkOptions) {
    memoryMaximumSize = '1g'
    jvmArgs = ['-XX:MaxPermSize=256m']
  }
}

task sourcesJar(type: Jar, dependsOn: classes) {
  classifier = 'sources'
  from sourceSets.main.allSource
}

task javadocJar(type: Jar, dependsOn: javadoc) {
  classifier = 'javadoc'
  from javadoc.destinationDir
}

idea {
  module {
    downloadSources = true
  }
}

task deploy(dependsOn: ['clean', 'install', 'uploadArchives'])

artifacts{
  archives sourcesJar
  archives javadocJar
}

uploadArchives {
  repositories {
    mavenDeployer {
      repository(url: "http://conjars.org/repo"){
        authentication(userName: conjarUsr,password: conjarPswd)
      }
    }
  }
}
